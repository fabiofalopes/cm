# Computação Móvel - Modelo de desenvolvimento HTML5

Olá, vamos então pegar nestes quatro modelos de desenvolvimento de aplicações móveis que já falámos um bocadinho e começar a entrar em mais detalhes aqui no HTML5. O HTML5 basicamente é fazer como se fosse um site, mas de forma que seja acessível em telemóvel. E nós normalmente imaginamos que isso é bastante limitativo em termos das capacidades que podemos usar do telemóvel, mas não é bem assim. Estas aplicações têm mais acesso do que vocês imaginam.

Por exemplo, se vocês apontarem agora o vosso telemóvel, vosso smartphone aqui para este QR Code ou entrar neste endereço, vão poder ver as características que conseguem aceder. O que é que está disponível para aceder via HTML JavaScript, não é, que incluindo JavaScript portanto via um browser normal tradicional. O que é que é possível já aceder e o que é que não é possível aceder? Podem agora fazer pausa deste vídeo e verificar essa situação.

Possivelmente se têm um Android, se têm acesso... Vamos ver que têm acesso a bastantes coisas. Tendo um iPhone, em princípio têm menos acesso. O iPhone é mais restritivo neste aspecto. Uma das coisas, por exemplo, que não sei se vocês têm noção disso, mas que é possível aceder facilmente a partir de qualquer telemóvel é o acelerómetro. Qualquer browser consegue aceder neste momento ao acelerómetro.

E por exemplo, podem experimentar esta aplicação apontando outra vez o vosso resultado normal depois de criar QR code, e basicamente isto vai recolher as leituras do acelerómetro do vosso telemóvel. Ou seja, experimentem abanar o telemóvel há um bocadinho e vão ver que ele reage. E isso é feito muito facilmente através deste evento que aqui está, e vão ver que é um evento standard. Vocês não têm que instalar nada de especial. É possivelmente em alguns telemóveis é pedida uma permissão para aceder ao acelerómetro, mas nada de especial. Portanto está acessível a partir de um browser normalíssimo.

É muito poderoso, mas tem dois grandes problemas. Nomeadamente o facto do utilizador se aperceber que está a correr num browser, ou seja, aparece lá em cima a barra do endereço, tem um back, tem um bookmark, etc. E isso não é bem a forma como uma aplicação deve funcionar. Mas talvez não seja muito grave. No entanto, se não tiver conectividade, não executa, não é? Como qualquer site, quando vocês tentam aceder a um site e não têm conectividade, ele simplesmente não executa. E isso não é claramente o que se espera de uma aplicação.

Então quando é que vamos usar o HTML5? Bem, eu pensei em três cenários - eventualmente há mais, mas só para ajudar com exemplos de situações onde, na minha opinião, faz sentido usar o HTML5 e normalmente acaba por ser uma solução mais complexa como desenvolver uma aplicação nativa ou híbrida nativa, quando não me parece que justifique o esforço para fazer uma delas.

É quando a utilização é muito pontual e não se justifica instalar uma aplicação, porque a grande diferença do HTML5 para os restantes modelos é que eu não tenho que instalar nada. Não tenho que ir à loja, descarregar a aplicação, instalá-la. Eu simplesmente acedo a um endereço que pode ser passado através de um link, clico no link e aquilo abre. Mais simples que isto é impossível.

Ora, para utilizações pontuais, como por exemplo consultar o cartaz no festival de verão em que a gente chega ao festival, sei lá, dois três dias antes, é quando a gente quer ver o cartaz, não é? E depois, enquanto estamos no festival, continuamos a querer ver o cartaz. Mas acabamos o festival, já não queremos saber do cartaz para nada. Então para que é que vamos instalar uma aplicação para usar durante alguns dias e depois desinstalar? Parece que não faz muito sentido. Às vezes até é só uma questão de minutos - eu quero só consultar uma informação, mas tenho que instalar uma aplicação para consultar essa informação. Mais vale usar HTML5.

Outra hipótese: aplicações que não exigem grandes funcionalidades. Sei lá, um conversor de quilómetros para milhas, aquele famoso que vocês fizeram em fundamentos de programação, uma coisa para dar a previsão do tempo como esta que estamos a ver aqui, uma calculadora. Esse tipo de aplicações não se justifica estar a criar toda uma aplicação nativa muitas vezes já para fazer uma coisa tão simples. Ah, e mais uma vez pensem: o que é que é preciso? Rapidamente converter quilómetros para milhas, têm que instalar uma aplicação para converter e a seguir desinstalar a aplicação?

Finalmente, aplicações em que o ponto de entrada é um motor de pesquisa. Ou seja, imaginem: vocês entram no telemóvel, entram no Google, não é? Fazem uma pesquisa no Google e dá-vos um conjunto de resultados. E um desses resultados pode abrir uma aplicação, porque não é? Pode não abrir uma página estática, pode abrir uma página altamente dinâmica que tem um aspecto de uma aplicação. E esta forma de aceder a uma aplicação é bastante mais simples e facilita a descoberta dessa aplicação do que propriamente ir a uma loja, à Play Store ou App Store, para descarregar a aplicação.

Bem, imaginando então que vocês estão convencidos com este modelo do HTML5, abandonaram os outros três, agora qual é o cuidado que vocês têm que ter? Bem, a primeira coisa é não tentar trazer simplesmente os sites da forma como foram desenhados para desktop para smartphone. Já sabemos isso há muitos anos que sabemos isso. Inclusivamente a Google até dá mais importância aos sites que são mobile friendly nos resultados de pesquisa, principalmente quando pesquisamos através do telemóvel. A Google não nos mostra resultados que sabe que quando a gente clicar lá no telemóvel assim vai abrir um site horrível que renderiza muito mal no telemóvel.

Então quais são as três características que a Google considera que tornam um site mobile friendly? Por um lado, o texto tem que ser legível sem necessidade de fazer zoom. Os botões têm que ter um espaçamento adequado. Isto é importante porque nós temos - e nós vamos falar disso mais à frente - nós às vezes temos alguma dificuldade: os botões são pequenos, em acertar no botão acertamos no botão do lado, e portanto não é isso que se pretende.

Imaginem que alguém tenha os dedos um bocadinho mais gordos, têm dificuldade em acertar neste botão sem acertar no de cima ou no de baixo, não é? Aquilo está ali tão juntinho, enquanto que aqui estão mais largos e portanto há menos probabilidade disso acontecer.

E finalmente, a página deve evitar scroll horizontal, sempre scroll vertical portanto. Isso é para ter mais informação que seja para baixo, para baixo, para baixo, e a pessoa vai fazendo scroll, do que estar a andar para o lado.

OK, então quais são as opções que temos para implementar um site preparado para mobile? Ora bem, temos três opções.

Primeira opção é o responsivo, que eu penso que vocês já terão, já estarão familiarizados com este termo de programação web eventualmente. Mas em que a ideia é que a página é a mesma, é aquilo, é um HTML que é igual para toda a gente, mas através do CSS a página adapta automaticamente ou também dependendo do tamanho - é maior ou menor, a página vai ajustar, vai ajustar os seus elementos de forma a ser diferente e tirar o melhor partido desse tamanho de ecrã. Portanto essa é uma técnica.

A outra é aquilo que se chama dynamic serving, que é o servidor perceber qual é o dispositivo que está a aceder e responder com uma página diferente. Ou seja, quando peço... quando faço um pedido no browser, não é? Aquilo que vai, um pedido para o servidor, percebe-se: "Calma, que isto é um tablet, ter com este tamanho, ok, então vou-lhe dar esta página. Calma, que isto é um smartphone, então vou-lhe dar esta página." Isto é o dynamic serving.

Finalmente, posso ter URLs específicos para mobile e para desktop. Portanto, se eu quiser ver a versão desktop, vou ser de um URL, é um endereço que tem específico para desktop, ou então um URL especificamente para mobile.

Vamos agora ver cada um destas três opções mais em detalhe, começando pelo responsive web design. Temos aqui um exemplo de um site que está, o mesmo site, o mesmo HTML está a ser apresentado de forma diferente em três ecrãs de tamanhos diferentes, não é?

Portanto temos aqui, por exemplo, um ecrã grande em que o site é apresentado desta forma. Entretanto o ecrã ficou mais pequeno, por exemplo, não estava tablet, e ele é ligeiramente apertado, mas todos os elementos continuam a aparecer aqui. Se repararmos, não há elementos que desaparecem, apenas o espaçamento entre alguns elementos fica menor. Por exemplo, aqui este espaçamento e este espaçamento aqui fica menor, mas ele continua a caber todo lá, e portanto não teve grandes alterações.

Mas se continuarmos a reduzir o tamanho até ficar, por exemplo, para um telemóvel... E imaginem, isto obviamente isto não é o ecrã do telemóvel, mas imaginem que o ecrã do telemóvel vem até aqui e depois o resto é scroll, não é? Como já não era possível que estes elementos coubessem, não é, tão estreito, é basicamente retirou-se a informação de uma linha e empurrou-se para baixo. E portanto agora o site tem aí organizado na vertical, se quiserem, de forma que eu tenha que fazer scroll para chegar à informação.

Mas acima de tudo, o que aconteceu foi: a fonte nunca ficou mais pequena por causa disto, não é? Não se tentou reduzir todo este site para uma coisa tão pequena que eu deixei de conseguir ler o que é que estava escrito. Eu apenas reorganizei a informação que lá estava.

Então, três técnicas que eu vou explicar agora. A primeira é o fluid layout, que é a ideia de que se eu organizar o meu site, o meu HTML, através de uma grelha virtual - a grelha não está visível, mas está lá por trás - então quando eu encolho o tamanho do ecrã, até mesmo fazendo resize da janela do browser, eu começo-me a aperceber disso: os elementos vão-se reajustando de forma fluida dentro dessa grelha virtual.

Podemos ver aqui, por exemplo, que o quatro já não cabe aqui quando isto encolheu, e portanto o quatro ficou, passou aqui para baixo. Cinco, seis vai passando aqui para baixo.

Outra é mais simples: é a ideia das imagens fluidas, é que as imagens devem fazer resize à medida que eu vou reduzindo o tamanho do ecrã, de forma a nunca criar um scroll horizontal. Nos primeiros sites, quando a gente acedia em mobile, a imagem era muito grande, a gente tinha que andar a fazer... aparecia um scroll horizontal horrível e a gente tinha que andar a fazer scroll para conseguir ver a imagem.

E finalmente, aquilo que é para mim o mais importante, que é aquilo que se chama media queries, que é eu no CSS poder definir características diferentes consoante a dimensão do ecrã. Isto é no fundo o segredo do responsive web design, que é eu poder dizer: se eu tenho o tamanho do ecrã, por exemplo, entre 480 pixels e 767 pixels, então este componente vai ter um tamanho de 460 pixels. Mas se eu estou entre 768 pixels e 1023 pixels, então este componente já pode estar com uma largura de 760 pixels. E por aí fora.

Portanto, o que acontece é: quando vem o HTML, a primeira coisa que o browser vai fazer é ver qual é o tamanho do ecrã, a seguir aplicar o CSS correto, aplicar estas... Isto é como se fosse um switch com vários cases, não é? Em que tenho case para cada tamanho, e dependendo do tamanho aplica então as classes correspondentes ao CSS e todas as características para o site ficar feito daquela forma, ser renderizado daquela forma.

Esta coisa de fazer media queries dá muito trabalho, não é? Já viram que a gente, para todos os componentes no site, desde os formulários, os campos, as listas, tudo, tudo o que nos é dear, tudo o que nos lembramos, teria que ser refeito desta forma, sempre com estes, esta espécie de switch. Ah, e está imenso trabalho fazer isto ou não?

Felizmente há quem já tenha feito isso e têm disponibilizado até frameworks ou tanto faz. Ah, uma das mais conhecidas é o Bootstrap. Ah, Bootstrap foi uma framework criada em 2011, até já tem alguns anos, mas ainda hoje é uma framework de referência. Inicialmente foi feita pela equipa do Twitter, mas atualmente é open source.

Implementa um fluid layout é desta forma - lembram-se que aquilo... Portanto tem a tal grelha virtual, e o que conseguimos dizer: "Olha, este aqui vai ocupar oito das 12 colunas" - é que eu tenho 12 colunas virtuais - "e aqui vai ocupar quatro das 12 colunas", por exemplo. E as imagens são automaticamente fluidas desde que a gente inclua esta classe aqui.

Pronto, há mais informação aqui neste site. Para não vou processar muito sobre isso aqui um bocadinho. A ideia é: se quiserem ir para o modelo responsivo, eu recomendo que usem uma das frameworks que já tratam disso, em vez de estarem vocês a fazer as media queries no CSS, porque está muito trabalho.

Agora avançando para o dynamic serving, que é: em vez de ser o browser a decidir, eh, com base no tamanho do ecrã, como é que vai renderizar o HTML - e o servidor nem sabe de nada, o servidor limita-se a enviar HTML e não sabe nada - no dynamic serving isso não é assim. O servidor vai controlar completamente este processo, porque ele vai receber, junto com o pedido HTTP, vai receber um cabeçalho em que esse cabeçalho indica qual é o tamanho do ecrã que está a ser usado, indica uma série de coisas que estão atrás: qual é o browser, etc. Há um conjunto de informação que é enviado em cada pedido.

Ele vai usar essa informação para decidir o que é que envia de volta para cada um dos dispositivos. Neste caso, apercebe-se que como se trata de um smartphone, então vai enviar um HTML especificamente perfeito para este tamanho. Se for um tablet, vai enviar especificamente feito para este tamanho de ecrã.

Ou seja, no fundo ele tem que ter já à partida um conjunto de HTMLs preparados para cada um dos tamanhos de ecrãs possíveis, não é? Aquilo não é automático aqui. Eu já vou preparado para este tamanho, ele já sabe à partida que vai ser renderizado neste tamanho.

Isto é uma coisa que é muito usada pelos sistemas de gestão de conteúdos. Portanto, existem ferramentas que gerem conteúdos e que permitem a utilizadores que não percebem nada de HTML gerir os conteúdos de um site. E para esses utilizadores, é muitas vezes dada a hipótese de definir uma página diferente consoante um conjunto de critérios.

Por exemplo, o Liferay é um desses sistemas de gestão de conteúdos, é um sistema de gestão de conteúdos orientado para as empresas. Ah, reparem: numa certa altura na configuração dele, ele permite fazer uma coisa deste género. Se a marca... isto, o que isto está a dizer é: relativamente não há pessoa que está a usar o Liferay, mas a quem vai aceder ao site, estão a ver? Portanto o Liferay está a alimentar um site, e cada utilizador que acede ao site, ah, a gente consegue verificar se a marca do telemóvel que está a ser usado é esta ou se o browser é este ou se o sistema operativo é este, etc. Portanto, criar aqui um conjunto de critérios. Então, nesse caso, se for isso, aplica este tema. Neste momento não tenho aqui nenhum tema, mas imaginem que eu tinha três ou quatro temas: um para ecrãs mais pequenos, outro para ecrãs maiores. Eu podia usar esta técnica. Isto chama-se dynamic serving.

Finalmente, temos então... só resumindo: temos o responsivo, que é o browser que decide e o servidor não sabe de nada. Temos o dynamic, que é o servidor que decide e o browser não tem que fazer nada, não tem que decidir nada. E finalmente temos um terceiro caso em que nem é o browser que decide, nem é o servidor que decide, é o utilizador que decide. Porque é? Porque existem dois endereços: existe um endereço para desktop, existe um endereço para mobile. E portanto, se eu quiser ver o desktop dentro de um mobile, consigo. E se eu quiser ver um mobile dentro de um desktop, consigo. Eu é que decido como é que quero fazer isso. E isso é simplesmente com um endereço próprio.

Neste caso, este site é que tem um "m" no final, e isto fica com aspecto mobile. O próprio Facebook também tem uma coisa deste género: se acederem a m.facebook, ele fica com este aspecto mobile. E portanto aqui é o utilizador que decide.

Então, resumindo a coisa: no responsive design, temos apenas que manter uma página independentemente do número de dispositivos, porque onde é feita a lógica de mudar a página consoante o dispositivo é no CSS. E como o CSS normalmente nos é dado - é um Bootstrap, uma coisa desse género - então fica relativamente simples de manter apenas uma página e automaticamente funcionar numa grande variedade de dispositivos. No entanto, só permite adaptar a página ao tamanho. Esta técnica tem que contar apenas o tamanho, não permite, por exemplo, adaptar por diferentes sistemas operativos ou marcas. Isso não dá para fazer.

Se quiséssemos fazê-lo, é o dynamic serving que permite controlar melhor a página que é mostrada. Ou seja, eu enquanto dono de um site consigo controlar completamente a página que é mostrada em cada caso. No entanto, dá uma trabalheira, porque eu tenho que desenvolver e manter uma página diferente para cada dispositivo. Imaginem que eu descubro um erro na página desktop: tenho que corrigir também o erro na página mobile. E se tiver várias páginas, uma para cada tamanho, uma para cada sistema operativo, uma para cada smartphone, tenho que atualizar em todas e tenho que estar sempre a manter tudo isto sincronizado. Portanto é bastante custoso.

Finalmente, o URL específico... pronto, é aquele que dá o poder ao utilizador. Podemos ver, no entanto, não é muito usado porque isto, ah, estraga ali um bocadinho a forma como nós acedemos à web, não é? Quer dizer, não há um endereço único de acesso ao site. Quando eu faço uma pesquisa no Google, o endereço que me aparece é qual? É o de um mobile? É o desktop? Estão a ver? Portanto, aquilo até pode dar os dois resultados no Google, porque é estranho, não é? É o mesmo site, pode por vias diferentes, mas como o URL é diferente, consegue perceber que na realidade é o mesmo site? Nem a Google consegue perceber isso.

Pronto, isto termina o... há tudo o que há para saber, digamos grosso modo, sobre HTML5. Eh, a seguir vou falar de... no próximo vídeo vou falar da híbrida web. 